<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 puppeteer + nodejs 爬取喜欢的动漫资源 | 小梅梅的二狗子</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/meimei/images/favicon.ico">
    <meta name="description" content="记录时光">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/meimei/assets/css/0.styles.bc684c35.css" as="style"><link rel="preload" href="/meimei/assets/js/app.e17b4371.js" as="script"><link rel="preload" href="/meimei/assets/js/2.970af444.js" as="script"><link rel="preload" href="/meimei/assets/js/19.1038800c.js" as="script"><link rel="prefetch" href="/meimei/assets/js/10.f097d8a1.js"><link rel="prefetch" href="/meimei/assets/js/11.f237bed0.js"><link rel="prefetch" href="/meimei/assets/js/12.25db751c.js"><link rel="prefetch" href="/meimei/assets/js/13.fafa65ea.js"><link rel="prefetch" href="/meimei/assets/js/14.e0a6bf79.js"><link rel="prefetch" href="/meimei/assets/js/15.e19139c1.js"><link rel="prefetch" href="/meimei/assets/js/16.a4c165c0.js"><link rel="prefetch" href="/meimei/assets/js/17.55d6b7df.js"><link rel="prefetch" href="/meimei/assets/js/18.8929c63f.js"><link rel="prefetch" href="/meimei/assets/js/20.a2a606e3.js"><link rel="prefetch" href="/meimei/assets/js/21.10f15bcd.js"><link rel="prefetch" href="/meimei/assets/js/22.4d316bc3.js"><link rel="prefetch" href="/meimei/assets/js/23.a3c5bf38.js"><link rel="prefetch" href="/meimei/assets/js/24.b7063922.js"><link rel="prefetch" href="/meimei/assets/js/25.fe2d9609.js"><link rel="prefetch" href="/meimei/assets/js/26.e39a956e.js"><link rel="prefetch" href="/meimei/assets/js/27.47651ada.js"><link rel="prefetch" href="/meimei/assets/js/3.0021f244.js"><link rel="prefetch" href="/meimei/assets/js/4.6afa3ba4.js"><link rel="prefetch" href="/meimei/assets/js/5.6a9b00c1.js"><link rel="prefetch" href="/meimei/assets/js/6.018937bc.js"><link rel="prefetch" href="/meimei/assets/js/7.a6e64ea3.js"><link rel="prefetch" href="/meimei/assets/js/8.2729f837.js"><link rel="prefetch" href="/meimei/assets/js/9.e45e831b.js">
    <link rel="stylesheet" href="/meimei/assets/css/0.styles.bc684c35.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/meimei/" class="home-link router-link-active"><img src="/meimei/images/logo.png" alt="小梅梅的二狗子" class="logo"> <span class="site-name can-hide">小梅梅的二狗子</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/meimei/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><!----> <span class="title" style="display:;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/meimei/pages/a418d9/" class="nav-link">fileReader</a></li><li class="dropdown-item"><!----> <a href="/meimei/pages/476230/" class="nav-link">canvas</a></li><li class="dropdown-item"><!----> <a href="/meimei/pages/7e6403/" class="nav-link">【css世界】学习笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><!----> <span class="title" style="display:;">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/52721a/" class="nav-link">vue cli2 升级vue cli3 采坑记录</a></li><li class="dropdown-subitem"><a href="/meimei/pages/60287c/" class="nav-link">vue-cli3 项目 token.type.endsWith is not a function 生产事故分析</a></li><li class="dropdown-subitem"><a href="/meimei/pages/2227be/" class="nav-link">使用vuepress 搭建团队文档</a></li></ul></li><li class="dropdown-item"><h4>node</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/873b11/" class="nav-link">nodjs 爬取喜欢的的背景图片</a></li><li class="dropdown-subitem"><a href="/meimei/pages/159617/" aria-current="page" class="nav-link router-link-exact-active router-link-active">使用 puppeteer + nodejs 爬取喜欢的动漫资源</a></li><li class="dropdown-subitem"><a href="/meimei/pages/d5e89d/" class="nav-link">puppeteer爬取aspx网站</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端部署相关" class="dropdown-title"><!----> <span class="title" style="display:;">前端部署相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>jenkins</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/6c49fd/" class="nav-link">Jenkins 从安装到自动部署h5</a></li><li class="dropdown-subitem"><a href="/meimei/pages/26c14e/" class="nav-link">vue自动部署项目到服务器</a></li><li class="dropdown-subitem"><a href="/meimei/pages/8729f4/" class="nav-link">jenkins自动打包前端代码并发布到测试或者生产</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="window环境工具推荐" class="dropdown-title"><!----> <span class="title" style="display:;">window环境工具推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vscode</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/6dc76d/" class="nav-link">Visual Studio Code 入门简介 常用插件介绍</a></li><li class="dropdown-subitem"><a href="/meimei/pages/af1081/" class="nav-link">vscode prettier eslint 插件格式化不生效的问题</a></li></ul></li><li class="dropdown-item"><h4>其他的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/f0df26/" class="nav-link">声卡问题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/meimei/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/meimei/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/meimei/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/meimei/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qinyuanqiblog/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatar-static.segmentfault.com/192/812/192812280-5ec40e5e3bdc0_huge256"> <div class="blogger-info"><h3>qinyuanqi</h3> <span>搬砖使我变强！冲！！！</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/meimei/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><!----> <span class="title" style="display:;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/meimei/pages/a418d9/" class="nav-link">fileReader</a></li><li class="dropdown-item"><!----> <a href="/meimei/pages/476230/" class="nav-link">canvas</a></li><li class="dropdown-item"><!----> <a href="/meimei/pages/7e6403/" class="nav-link">【css世界】学习笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><!----> <span class="title" style="display:;">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/52721a/" class="nav-link">vue cli2 升级vue cli3 采坑记录</a></li><li class="dropdown-subitem"><a href="/meimei/pages/60287c/" class="nav-link">vue-cli3 项目 token.type.endsWith is not a function 生产事故分析</a></li><li class="dropdown-subitem"><a href="/meimei/pages/2227be/" class="nav-link">使用vuepress 搭建团队文档</a></li></ul></li><li class="dropdown-item"><h4>node</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/873b11/" class="nav-link">nodjs 爬取喜欢的的背景图片</a></li><li class="dropdown-subitem"><a href="/meimei/pages/159617/" aria-current="page" class="nav-link router-link-exact-active router-link-active">使用 puppeteer + nodejs 爬取喜欢的动漫资源</a></li><li class="dropdown-subitem"><a href="/meimei/pages/d5e89d/" class="nav-link">puppeteer爬取aspx网站</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端部署相关" class="dropdown-title"><!----> <span class="title" style="display:;">前端部署相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>jenkins</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/6c49fd/" class="nav-link">Jenkins 从安装到自动部署h5</a></li><li class="dropdown-subitem"><a href="/meimei/pages/26c14e/" class="nav-link">vue自动部署项目到服务器</a></li><li class="dropdown-subitem"><a href="/meimei/pages/8729f4/" class="nav-link">jenkins自动打包前端代码并发布到测试或者生产</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="window环境工具推荐" class="dropdown-title"><!----> <span class="title" style="display:;">window环境工具推荐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vscode</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/6dc76d/" class="nav-link">Visual Studio Code 入门简介 常用插件介绍</a></li><li class="dropdown-subitem"><a href="/meimei/pages/af1081/" class="nav-link">vscode prettier eslint 插件格式化不生效的问题</a></li></ul></li><li class="dropdown-item"><h4>其他的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/meimei/pages/f0df26/" class="nav-link">声卡问题</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/meimei/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/meimei/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/meimei/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/meimei/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qinyuanqiblog/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>basics</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>practice</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>frame</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Element-ui</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>node</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/meimei/pages/873b11/" class="sidebar-link">nodjs 爬取喜欢的的背景图片</a></li><li><a href="/meimei/pages/159617/" aria-current="page" class="active sidebar-link">使用 puppeteer + nodejs 爬取喜欢的动漫资源</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#起源" class="sidebar-link">起源</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#最终效果" class="sidebar-link">最终效果</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#下载后的文件名不是-mp4-怎么解决" class="sidebar-link">下载后的文件名不是.mp4 怎么解决</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#作者在写这篇文章的技能和环境" class="sidebar-link">作者在写这篇文章的技能和环境</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#开始分析网站-随便搜一个喜欢的动漫" class="sidebar-link">开始分析网站, 随便搜一个喜欢的动漫</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#随便点击一个播放地址-f12-搞起来-分析页面" class="sidebar-link">随便点击一个播放地址，F12 搞起来，分析页面</a></li><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#如何跳过debugger死循环" class="sidebar-link">如何跳过debugger死循环</a></li><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#找到页面播放地址" class="sidebar-link">找到页面播放地址</a></li><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#分析播放地址由来" class="sidebar-link">分析播放地址由来</a></li><li class="sidebar-sub-header level4"><a href="/meimei/pages/159617/#思路1-通过接口请求分析-是否存在共通点" class="sidebar-link">思路1：通过接口请求分析，是否存在共通点</a></li><li class="sidebar-sub-header level4"><a href="/meimei/pages/159617/#思路2-直接看播放器的源码逻辑-找到url的拼接逻辑" class="sidebar-link">思路2：直接看播放器的源码逻辑，找到url的拼接逻辑</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#找出播放器源码-直接通过调试工具找到所有的js文件-然后随便看看" class="sidebar-link">找出播放器源码，直接通过调试工具找到所有的js文件，然后随便看看</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#分析播放器源码" class="sidebar-link">分析播放器源码</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#全局变量-player-aaaa" class="sidebar-link">全局变量 player_aaaa</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#会做赋值存储-然后会引入一个js文件-文件名-static-player-parse-js" class="sidebar-link">会做赋值存储，然后会引入一个js文件，文件名：/static/player/parse.js</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#打开调试工具-找到-static-player-parse-js文件" class="sidebar-link">打开调试工具，找到/static/player/parse.js文件，</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#static-player-parse-js-文件内容" class="sidebar-link">/static/player/parse.js 文件内容</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#浏览器控制台输入-macplayer-parse-macplayer-playurl" class="sidebar-link">浏览器控制台输入：MacPlayer.Parse + MacPlayer.PlayUrl</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#右键保存" class="sidebar-link">右键保存？</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#如何做自动化" class="sidebar-link">如何做自动化？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#使用puppeteer解析页面-获取到视频资源地址-然后使用nodejs自动下载视频" class="sidebar-link">使用puppeteer解析页面，获取到视频资源地址，然后使用nodejs自动下载视频</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#思路1-遍历出播放列表-然后开始一个任务-依次打开页面-找到资源地址-然后收集到所有的播放资源地址-使用nodejs下载到本地" class="sidebar-link">思路1：遍历出播放列表，然后开始一个任务，依次打开页面，找到资源地址，然后收集到所有的播放资源地址，使用nodejs下载到本地，</a></li><li class="sidebar-sub-header level4"><a href="/meimei/pages/159617/#为啥不用上面那个思路-因为那个思路我把代码写完-测试了一下-发现他的服务器扛不住哈-所以还是保险点-一次一个操作" class="sidebar-link">为啥不用上面那个思路，因为那个思路我把代码写完，测试了一下，发现他的服务器扛不住哈，所以还是保险点，一次一个操作</a></li><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#思路2-使用puppetee-自动触发右键下载-并保存到我们想要下载的地方-目前没有尝试这个方法" class="sidebar-link">思路2：使用puppetee 自动触发右键下载，并保存到我们想要下载的地方（目前没有尝试这个方法）</a></li><li class="sidebar-sub-header level3"><a href="/meimei/pages/159617/#思路3-遍历出播放列表-然后开始一个任务-从第一个开始-打开页面-找到资源地址-使用nodejs下载到本地-下载完成-开始下一个就这样" class="sidebar-link">思路3：遍历出播放列表，然后开始一个任务，从第一个开始，打开页面，找到资源地址，使用nodejs下载到本地，下载完成，开始下一个就这样</a></li><li class="sidebar-sub-header level4"><a href="/meimei/pages/159617/#思路3-难点分析" class="sidebar-link">思路3 难点分析</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#pupeteer-如何获取元素的属性-别问我-反正我不懂-堆栈溢出大佬告诉我的" class="sidebar-link">pupeteer 如何获取元素的属性，别问我，反正我不懂， 堆栈溢出大佬告诉我的</a></li><li class="sidebar-sub-header level5"><a href="/meimei/pages/159617/#nodejs下载远端视频-并显示进度" class="sidebar-link">nodejs下载远端视频，并显示进度</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#完整代码" class="sidebar-link">完整代码</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#免责声明" class="sidebar-link">免责声明</a></li><li class="sidebar-sub-header level2"><a href="/meimei/pages/159617/#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/meimei/pages/d5e89d/" class="sidebar-link">puppeteer + cheerio + mysql 模拟用户去爬取一个aspx网站</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>deploy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>window</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网易</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/meimei/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/meimei/categories/?category=web" title="分类" data-v-06225672>web</a></li><li data-v-06225672><a href="/meimei/categories/?category=frame" title="分类" data-v-06225672>frame</a></li><li data-v-06225672><a href="/meimei/categories/?category=node" title="分类" data-v-06225672>node</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/qinyuanqiblog" target="_blank" title="作者" class="beLink" data-v-06225672>qinyuanqi</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-04-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">使用 puppeteer + nodejs 爬取喜欢的动漫资源<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="起源"><a href="#起源" class="header-anchor">#</a> 起源</h2> <ul><li>最近突然想尝试剪视频，所以就想先从动漫开始，二次元搞起来，剪视频就必须需要原视频，怎么找到这些资源呢，知乎一搜一大把</li> <li>我经常会上六DM 里面去看动漫,里面的动漫清晰度也还可以，所以就想怎么写个爬虫直接把喜欢的动漫下载下来，毕竟是干前端的，手动下载有点丢人把 😄😄😄</li></ul> <h2 id="最终效果"><a href="#最终效果" class="header-anchor">#</a> 最终效果</h2> <p><img src="https://api2.mubu.com/v3/document_image/3b4a9907-f3a4-4ed8-aa95-a90219b72eeb-2331693.jpg" alt="效果图"> <img src="https://api2.mubu.com/v3/document_image/5d0810bc-b69d-4514-9c51-066640023495-2331693.jpg" alt="效果图"> <img src="https://api2.mubu.com/v3/document_image/7b5a7786-6473-4bad-8094-1a9a53bb969f-2331693.jpg" alt="效果图"></p> <h2 id="下载后的文件名不是-mp4-怎么解决"><a href="#下载后的文件名不是-mp4-怎么解决" class="header-anchor">#</a> 下载后的文件名不是.mp4 怎么解决</h2> <blockquote><p>比如说我下载的这个龙猫就是啥yum格式的，我直接后缀名改成.mp4 搞定，如果还不行，就上个格式工厂 应该就好了
<img src="https://api2.mubu.com/v3/document_image/9cdcbf9e-6055-4dfb-b13a-0e552e56e09c-2331693.jpg" alt="效果图"> <img src="https://api2.mubu.com/v3/document_image/cd08e69e-acf7-4156-82d7-bfa2ff72d65a-2331693.jpg" alt="效果图"> <img src="https://api2.mubu.com/v3/document_image/27cecfe6-ab41-43f6-917b-137b5f6af53a-2331693.jpg" alt="效果图"></p></blockquote> <h2 id="作者在写这篇文章的技能和环境"><a href="#作者在写这篇文章的技能和环境" class="header-anchor">#</a> 作者在写这篇文章的技能和环境</h2> <ul><li>前端略懂一二</li> <li>nodejs 一窍不通</li> <li>window系统</li> <li>puppeteer 版本: 14.3.0</li> <li>node版本: 16.1.0</li></ul> <h2 id="开始分析网站-随便搜一个喜欢的动漫"><a href="#开始分析网站-随便搜一个喜欢的动漫" class="header-anchor">#</a> 开始分析网站, 随便搜一个喜欢的动漫</h2> <p>介绍页
<img src="https://api2.mubu.com/v3/document_image/75698900-05d5-4cc2-9c5c-fc7796f28801-2331693.jpg" alt="效果图"></p> <h3 id="随便点击一个播放地址-f12-搞起来-分析页面"><a href="#随便点击一个播放地址-f12-搞起来-分析页面" class="header-anchor">#</a> 随便点击一个播放地址，F12 搞起来，分析页面</h3> <blockquote><p>可以，这个网站还是会玩的，调试工具开起来就给我一直debugger
<img src="https://api2.mubu.com/v3/document_image/82f50915-7276-4acc-9c81-a4e8d6e88f8a-2331693.jpg" alt="效果图"></p></blockquote> <h3 id="如何跳过debugger死循环"><a href="#如何跳过debugger死循环" class="header-anchor">#</a> 如何跳过debugger死循环</h3> <blockquote><p>这种方式可以方便跳过死循环，并且我们还可以继续调试
<img src="https://api2.mubu.com/v3/document_image/bf15eacc-657c-4763-9490-e8be57bff3c8-2331693.jpg" alt="效果图"> <img src="https://api2.mubu.com/v3/document_image/68087dbc-cc12-4c59-a4c9-3fd36d299580-2331693.jpg" alt="效果图"></p></blockquote> <h3 id="找到页面播放地址"><a href="#找到页面播放地址" class="header-anchor">#</a> 找到页面播放地址</h3> <blockquote><p>这个网站还是很简单的， 直接把资源地址丢到iframe里面而已，难度降低了，怪不得不给别人调试，😄😄
<img src="https://api2.mubu.com/v3/document_image/95da9abc-068f-4f47-80b5-1d65842d3319-2331693.jpg" alt="效果图"></p></blockquote> <h3 id="分析播放地址由来"><a href="#分析播放地址由来" class="header-anchor">#</a> 分析播放地址由来</h3> <h4 id="思路1-通过接口请求分析-是否存在共通点"><a href="#思路1-通过接口请求分析-是否存在共通点" class="header-anchor">#</a> 思路1：通过接口请求分析，是否存在共通点</h4> <blockquote><p>经过抓包，发现第一集和第二集的播放资源路径没有共同性可言，放弃o(╥﹏╥)o
<img src="https://api2.mubu.com/v3/document_image/dade251d-faa0-4b3d-8a25-e27c6de6e5bd-2331693.jpg" alt="效果图"></p></blockquote> <h4 id="思路2-直接看播放器的源码逻辑-找到url的拼接逻辑"><a href="#思路2-直接看播放器的源码逻辑-找到url的拼接逻辑" class="header-anchor">#</a> 思路2：直接看播放器的源码逻辑，找到url的拼接逻辑</h4> <h5 id="找出播放器源码-直接通过调试工具找到所有的js文件-然后随便看看"><a href="#找出播放器源码-直接通过调试工具找到所有的js文件-然后随便看看" class="header-anchor">#</a> 找出播放器源码，直接通过调试工具找到所有的js文件，然后随便看看</h5> <p><img src="https://api2.mubu.com/v3/document_image/2d2d1e37-51d8-4327-be1b-ecd103557031-2331693.jpg" alt="效果图"></p> <h5 id="分析播放器源码"><a href="#分析播放器源码" class="header-anchor">#</a> 分析播放器源码</h5> <blockquote><p>读取播放器源码发现，这个网站会在页面里面存入一个全局变量
<img src="https://api2.mubu.com/v3/document_image/00e35f62-3938-4747-9ae7-4461e531dff1-2331693.jpg" alt="效果图"></p></blockquote> <h5 id="全局变量-player-aaaa"><a href="#全局变量-player-aaaa" class="header-anchor">#</a> 全局变量 player_aaaa</h5> <ul><li><img src="https://api2.mubu.com/v3/document_image/dbea705d-4fdf-463d-b709-3a9ecb704ebe-2331693.jpg" alt="效果图"></li> <li><img src="https://api2.mubu.com/v3/document_image/447e3d5f-3753-45cb-b0d6-b30a5148cdb2-2331693.jpg" alt="效果图"></li></ul> <h5 id="会做赋值存储-然后会引入一个js文件-文件名-static-player-parse-js"><a href="#会做赋值存储-然后会引入一个js文件-文件名-static-player-parse-js" class="header-anchor">#</a> 会做赋值存储，然后会引入一个js文件，文件名：/static/player/parse.js</h5> <ul><li><img src="https://api2.mubu.com/v3/document_image/d2494800-baa2-4cbb-bf85-e57a392ca1b9-2331693.jpg" alt="效果图"></li></ul> <h5 id="打开调试工具-找到-static-player-parse-js文件"><a href="#打开调试工具-找到-static-player-parse-js文件" class="header-anchor">#</a> 打开调试工具，找到/static/player/parse.js文件，</h5> <ul><li><img src="https://api2.mubu.com/v3/document_image/8eb212ba-3173-4aff-8dbc-56ba59cda52b-2331693.jpg" alt="效果图"></li></ul> <h5 id="static-player-parse-js-文件内容"><a href="#static-player-parse-js-文件内容" class="header-anchor">#</a> /static/player/parse.js 文件内容</h5> <ul><li><img src="https://api2.mubu.com/v3/document_image/1855940c-18ba-4561-a46f-3f1e327d0b3f-2331693.jpg" alt="效果图"></li></ul> <h5 id="浏览器控制台输入-macplayer-parse-macplayer-playurl"><a href="#浏览器控制台输入-macplayer-parse-macplayer-playurl" class="header-anchor">#</a> 浏览器控制台输入：MacPlayer.Parse + MacPlayer.PlayUrl</h5> <blockquote><p>因为播放器的源码是一个自执行函数，然后我们又看到这个parse.js 文件里面的资源拼接方式，所以我们可以在浏览器的控制台里面直接把这个资源给拼出来</p></blockquote> <ul><li><img src="https://api2.mubu.com/v3/document_image/f336c5a8-2fee-4949-ab23-251a2c3a18b1-2331693.jpg" alt="效果图"></li></ul> <h5 id="右键保存"><a href="#右键保存" class="header-anchor">#</a> 右键保存？</h5> <blockquote><p>把上面的地址放到浏览器里面访问，发现就是我们想下载的资源了， 到了这一步骤，我们就可以右键保存了，当然作为一名合格的前端，我们怎么可能会去右键保存呢，接下来我们就准备上大杀器，puppeteer 配合nodejs 来帮我们实现自动下载
<a href="https://danmu.yhdmjx.com/m3u8.php?url=5BHZgz8M0ps5P4wbTU%2BuhFqXvQJZHkbJo0Vzo1uDgNuU1buMWjaWCGbxQKzTM9ln" target="_blank" rel="noopener noreferrer">资源demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li><img src="https://api2.mubu.com/v3/document_image/34b6e042-2818-46bb-9af3-706fdfc3d230-2331693.jpg" alt="效果图"></li></ul> <h5 id="如何做自动化"><a href="#如何做自动化" class="header-anchor">#</a> 如何做自动化？</h5> <ul><li>通过上面的连接，会进入到一个解析页面，因为我们要做成自动下载的，必须要找到视频源连接，否则不行，o(╥﹏╥)o</li> <li>查找元素页面，发现了最终的资源地址</li> <li><a href="https://v6-default.ixigua.com/3402f71ea71a90facc0aae3dd0f759c3/62a1ee34/video/tos/cn/tos-cn-v-c9e10a/dc23fecd7c8b43a58a45da68b9e19b8c/" target="_blank" rel="noopener noreferrer">最终的资源地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <img src="https://api2.mubu.com/v3/document_image/f2eb1368-86f0-4946-bb6e-81644d61b357-2331693.jpg" alt="效果图"></li></ul> <h2 id="使用puppeteer解析页面-获取到视频资源地址-然后使用nodejs自动下载视频"><a href="#使用puppeteer解析页面-获取到视频资源地址-然后使用nodejs自动下载视频" class="header-anchor">#</a> 使用puppeteer解析页面，获取到视频资源地址，然后使用nodejs自动下载视频</h2> <h3 id="思路1-遍历出播放列表-然后开始一个任务-依次打开页面-找到资源地址-然后收集到所有的播放资源地址-使用nodejs下载到本地"><a href="#思路1-遍历出播放列表-然后开始一个任务-依次打开页面-找到资源地址-然后收集到所有的播放资源地址-使用nodejs下载到本地" class="header-anchor">#</a> 思路1：遍历出播放列表，然后开始一个任务，依次打开页面，找到资源地址，然后收集到所有的播放资源地址，使用nodejs下载到本地，</h3> <p><img src="https://api2.mubu.com/v3/document_image/6d222778-7825-4302-8d17-c1178d27fa49-2331693.jpg" alt="效果图"></p> <h4 id="为啥不用上面那个思路-因为那个思路我把代码写完-测试了一下-发现他的服务器扛不住哈-所以还是保险点-一次一个操作"><a href="#为啥不用上面那个思路-因为那个思路我把代码写完-测试了一下-发现他的服务器扛不住哈-所以还是保险点-一次一个操作" class="header-anchor">#</a> 为啥不用上面那个思路，因为那个思路我把代码写完，测试了一下，发现他的服务器扛不住哈，所以还是保险点，一次一个操作</h4> <h3 id="思路2-使用puppetee-自动触发右键下载-并保存到我们想要下载的地方-目前没有尝试这个方法"><a href="#思路2-使用puppetee-自动触发右键下载-并保存到我们想要下载的地方-目前没有尝试这个方法" class="header-anchor">#</a> 思路2：使用puppetee 自动触发右键下载，并保存到我们想要下载的地方（目前没有尝试这个方法）</h3> <h3 id="思路3-遍历出播放列表-然后开始一个任务-从第一个开始-打开页面-找到资源地址-使用nodejs下载到本地-下载完成-开始下一个就这样"><a href="#思路3-遍历出播放列表-然后开始一个任务-从第一个开始-打开页面-找到资源地址-使用nodejs下载到本地-下载完成-开始下一个就这样" class="header-anchor">#</a> 思路3：遍历出播放列表，然后开始一个任务，从第一个开始，打开页面，找到资源地址，使用nodejs下载到本地，下载完成，开始下一个就这样</h3> <h4 id="思路3-难点分析"><a href="#思路3-难点分析" class="header-anchor">#</a> 思路3 难点分析</h4> <h5 id="pupeteer-如何获取元素的属性-别问我-反正我不懂-堆栈溢出大佬告诉我的"><a href="#pupeteer-如何获取元素的属性-别问我-反正我不懂-堆栈溢出大佬告诉我的" class="header-anchor">#</a> pupeteer 如何获取元素的属性，别问我，反正我不懂， 堆栈溢出大佬告诉我的</h5> <ul><li><a href="https://stackoverflow.com/questions/56467696/get-the-value-of-html-attributes-using-puppeteer" target="_blank" rel="noopener noreferrer">堆栈溢出的答案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><img src="https://api2.mubu.com/v3/document_image/ce86325c-69f3-4b1a-9aaa-83a85236c3e7-2331693.jpg" alt="效果图"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 获取单个</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token string">'document.querySelector(&quot;span.styleNumber&quot;).getAttribute(&quot;data-Color&quot;)'</span><span class="token punctuation">)</span>
<span class="token comment">// 获取多个</span>
<span class="token keyword">const</span> attr <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$$eval</span><span class="token punctuation">(</span><span class="token string">&quot;span.styleNumber&quot;</span><span class="token punctuation">,</span> <span class="token parameter">el</span> <span class="token operator">=&gt;</span> el<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-Color&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="nodejs下载远端视频-并显示进度"><a href="#nodejs下载远端视频-并显示进度" class="header-anchor">#</a> nodejs下载远端视频，并显示进度</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span>
<span class="token comment">// 我的demo使用的是axios 来下载</span>
<span class="token keyword">const</span> axiosRequest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./utils/request'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 这是一个axios实例</span>
axiosRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://media.w3.org/2010/05/sintel/trailer.mp4'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">responseType</span><span class="token operator">:</span> <span class="token string">'stream'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">// 返回头里面的content-length字段，会告诉我们这个视频有多大</span>
<span class="token comment">//  获取视频总长度 byte为单位</span>
<span class="token keyword">const</span> totalLength <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-length'</span><span class="token punctuation">]</span>
<span class="token comment">// 当前数据的总长度</span>
<span class="token keyword">let</span> totalChunkLength <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">// 当前读取的流</span>
<span class="token keyword">const</span> readSteam <span class="token operator">=</span> response<span class="token punctuation">.</span>data
<span class="token comment">// 读取流会触发的事件</span>
readSteam<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
totalChunkLength <span class="token operator">+=</span> chunk<span class="token punctuation">.</span>length
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据传输中，当前进度==&gt;'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>totalChunkLength <span class="token operator">/</span> totalLength<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 读取完成的时间</span>
readSteam<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'获取远端数据完毕'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 读取错误会触发的事件</span>
readSteam<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'获取远端数据完毕，发生了错误,错误信息==&gt;'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写入本地的文件名</span>
<span class="token keyword">const</span> fileName <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">.</span>mp4
<span class="token comment">// 调用nodejs写入文件方法</span>
<span class="token keyword">const</span> writeFile <span class="token operator">=</span> readSteam<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 写入完成事件</span>
writeFile<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;finish&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
writeFile<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;恭喜大哥，本地数据写入完成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写入错误触发的事件</span>
writeFile<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;不好意思，写入本地文件发生异常，错误信息==&gt;&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//axios 代码如下</span>
<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>

<span class="token comment">// 创建axios实例</span>
<span class="token keyword">const</span> service <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// api 的 base_url</span>
 <span class="token comment">// 永不凋谢，真男人 就是这么持久 😄😄</span>
 <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">90000000</span> <span class="token comment">// 请求超时时间</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// request拦截器</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
 <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

   <span class="token keyword">return</span> config
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// Do something with request error</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token comment">// for debug</span>
   Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// 响应拦截器</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
 <span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   
     <span class="token keyword">return</span> response
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">)</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="完整代码"><a href="#完整代码" class="header-anchor">#</a> 完整代码</h2> <p><a href="https://github.com/qinyuanqiblog/puppeteer-reptile" target="_blank" rel="noopener noreferrer">完整代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="免责声明"><a href="#免责声明" class="header-anchor">#</a> 免责声明</h2> <ul><li>首先 非常感谢这个网站让我这个老二次元能够找到喜欢的片源 😄😄😄</li> <li>本项目只是学习使用，无意对此网站进行爬虫等操作</li> <li>希望想用的同学自己玩玩就行，树大招风</li> <li>侵权请联系，立马删除</li> <li>就这些吧</li></ul> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p><a href="https://www.52pojie.cn/thread-1618559-1-1.html" target="_blank" rel="noopener noreferrer">破解视频的另一个思路<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://stackoverflow.com/questions/56467696/get-the-value-of-html-attributes-using-puppeteer" target="_blank" rel="noopener noreferrer">puppeterr 获取元素属性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.scrapingbee.com/blog/download-file-puppeteer/" target="_blank" rel="noopener noreferrer">puppeterr 下载文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/04/25, 18:37:28</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/meimei/pages/873b11/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">nodjs 爬取喜欢的的背景图片</div></a> <a href="/meimei/pages/d5e89d/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">puppeteer + cheerio + mysql 模拟用户去爬取一个aspx网站</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/meimei/pages/873b11/" class="prev">nodjs 爬取喜欢的的背景图片</a></span> <span class="next"><a href="/meimei/pages/d5e89d/">puppeteer + cheerio + mysql 模拟用户去爬取一个aspx网站</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/meimei/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/meimei/pages/8729f4/"><div>
            jenkins自动打包前端代码并发布到测试或者生产
            <!----></div></a> <span class="date">04-25</span></dt></dl><dl><dd>02</dd> <dt><a href="/meimei/pages/a418d9/"><div>
            fileReader
            <!----></div></a> <span class="date">04-25</span></dt></dl><dl><dd>03</dd> <dt><a href="/meimei/pages/476230/"><div>
            canvas
            <!----></div></a> <span class="date">04-25</span></dt></dl> <dl><dd></dd> <dt><a href="/meimei/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:592644285@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/qinyuanqiblog" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/playlist?id=114520484" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/meimei/assets/js/app.e17b4371.js" defer></script><script src="/meimei/assets/js/2.970af444.js" defer></script><script src="/meimei/assets/js/19.1038800c.js" defer></script>
  </body>
</html>
