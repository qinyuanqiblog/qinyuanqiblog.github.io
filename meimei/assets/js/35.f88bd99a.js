(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{430:function(t,e,r){"use strict";r.r(e);var a=r(12),s=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),e("blockquote",[e("p",[t._v("最近产品大哥说要把电商项目改成支持视频播放，视频要在后管项目上可以上传到七牛云，100M以上的这种视频，因为我们nginx限制了只能上传30m，所以只能采用前端直传七牛云的这个方案")])]),t._v(" "),e("h2",{attrs:{id:"项目介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目介绍"}},[t._v("#")]),t._v(" 项目介绍")]),t._v(" "),e("p",[t._v("这是一个基于若依的前后端不分离的项目，前端代码卸载jsp里面，主要是后台大哥在维护，我们需要帮助后台做好前端直传这个动作。")]),t._v(" "),e("h2",{attrs:{id:"前端直传七牛云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端直传七牛云"}},[t._v("#")]),t._v(" 前端直传七牛云")]),t._v(" "),e("h3",{attrs:{id:"如何注册账号-创建空间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何注册账号-创建空间"}},[t._v("#")]),t._v(" 如何注册账号，创建空间")]),t._v(" "),e("ul",[e("li",[t._v("一般这一步，不需要我们做，可以做为了解："),e("a",{attrs:{href:"https://developer.qiniu.com/kodo/1233/console-quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.qiniu.com/kodo/1233/console-quickstart"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"如何上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何上传"}},[t._v("#")]),t._v(" 如何上传？")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://developer.qiniu.com/kodo/1234/upload-types",target:"_blank",rel:"noopener noreferrer"}},[t._v("七牛云官网上传资源文档"),e("OutboundLink")],1)]),t._v(" "),e("ul",[e("li",[e("p",[t._v("官网说有两种上传方式，一种是表单上传，")])]),t._v(" "),e("li",[e("p",[t._v("我们就需要上传一个一两百m的东西，为啥要用sdk上传? 直接 用表单直传不香吗？感觉是决策失误了，哈哈，整个毛的分片上传！！")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/0e6f4631-10e2-4498-a4a7-7680c75c2f03-2331693.jpg",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"表单上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#表单上传"}},[t._v("#")]),t._v(" 表单上传")]),t._v(" "),e("blockquote",[e("p",[t._v("还是表单简单！！ 为啥要给自己找事！！！")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/ab48508f-6d4c-4b7c-b894-e7dba81cf2e6-2331693.jpg",alt:""}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/3a6f7f7f-0899-40c4-92fa-28030e2e63bc-2331693.jpg",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"分片上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分片上传"}},[t._v("#")]),t._v(" 分片上传")]),t._v(" "),e("ul",[e("li",[e("ol",[e("li",[t._v("分片上传，需要使用七牛云官网的sdk，如果找不到可以去："),e("a",{attrs:{href:"https://www.bootcdn.cn/qiniu-js/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bootcdn.cn/qiniu-js/"),e("OutboundLink")],1)])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"2"}},[e("li",[t._v("开始上传调用七牛云的上传方法")])])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/5ac0090a-8f0b-4896-8162-b85751e1d553-2331693.jpg",alt:""}})]),t._v(" "),e("ul",[e("li",[e("ol",{attrs:{start:"3"}},[e("li",[t._v("从后台得到token 和domain，因为七牛云上传成功之后的外链是 domain /  key这种形式，这个坑我也踩了，浪费半个小时")])])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://developer.qiniu.com/kodo/kb/1321/how-to-acquire-the-outside-storage-file-links?category=kb",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何获取上传后的外网地址"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/6cf87ab7-594b-49fc-80dd-b0d2c1d5add7-2331693.jpg",alt:""}})]),t._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[t._v("必须保证key的唯一性，建议采用时间戳 +随机数+文件名的方式")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/e2a648ff-a9fc-4bf2-913a-6df4373a7e7e-2331693.jpg",alt:""}})]),t._v(" "),e("p",[t._v("5.一个文件的大概上传流程图")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/6bc785b9-6570-4dec-b020-e946800ee20a-2331693.jpg",alt:""}})]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/qinyuanqiblog/wheel/blob/master/%E5%89%8D%E7%AB%AF%E4%B8%83%E7%89%9B%E4%BA%913.0sdk%E7%9B%B4%E4%BC%A0demo.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://developer.qiniu.com/kodo/sdk/javascript#demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("七牛云官方文档"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"还碰到了一个谷歌浏览器无法预览avi格式的问题-mp4格式的没问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#还碰到了一个谷歌浏览器无法预览avi格式的问题-mp4格式的没问题"}},[t._v("#")]),t._v(" 还碰到了一个谷歌浏览器无法预览avi格式的问题，mp4格式的没问题")]),t._v(" "),e("ul",[e("li",[e("span",{staticStyle:{color:"red"}},[t._v("问题原因：Chrome只支持标准的H.264方式编码")])])]),t._v(" "),e("h3",{attrs:{id:"解决办法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),e("ul",[e("li",[e("ol",[e("li",[t._v("后台做格式转换，因为现在后台是七牛云，七牛云也有对应的这种服务，是收费的")])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"2"}},[e("li",[t._v("使用流媒体的方式可以支持任意格式")])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"3"}},[e("li",[t._v("委屈一下运营小妹子，只能上传mp4格式(我选择了这个，哈哈)")])])])]),t._v(" "),e("h3",{attrs:{id:"浏览器视频格式支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器视频格式支持"}},[t._v("#")]),t._v(" 浏览器视频格式支持")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/00eb979a-ccf9-483b-ae5c-a70f0071aad8-2331693.jpg",alt:""}})]),t._v(" "),e("ul",[e("li",[e("p",[t._v("谷歌浏览器支持mp4播放格式，但是MP4的视频格式可以使用DivX也可使用H264，Chrome只支持H264。")])]),t._v(" "),e("li",[e("p",[t._v("常用视频格式mp4,mov,avi，谷歌浏览器仅支持mp4中H264视频格式，safari支持mov，mp4但avi不支持，发现web端浏览器对这些支持并不好，相比较而言移动端还可以")])]),t._v(" "),e("li",[e("p",[t._v("视频比较大，直接在加载整个页面显然不是最好的选择，于是想到了m3u8流媒体，将一个大的媒体文件进行分片直接用播放器进行在线播放")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/53f42516-bb6e-4da4-8f94-7060710ed81c-2331693.jpg",alt:""}})]),t._v(" "),e("ul",[e("li",[e("p",[t._v("MP4容器、H.264/AVC视频编码、AAC音频编码")])]),t._v(" "),e("li",[e("p",[t._v("MP4容器，H.265/HEVC视频编码，AAC音频编码")])]),t._v(" "),e("li",[e("p",[t._v("MP4容器，DIVX视频编码，MP3音频编码")])]),t._v(" "),e("li",[e("p",[t._v("FLV容器，H.264/AVC视频编码，AAC音频编码")])]),t._v(" "),e("li",[e("p",[t._v("FLV容器，H.265/HEVC视频编码，AAC音频编码")])]),t._v(" "),e("li",[e("p",[t._v("AVI容器，DIVX视频编码，MP3音频编码")])]),t._v(" "),e("li",[e("p",[t._v("AVI容器，XVID视频编码，MP3音频编码")])]),t._v(" "),e("li",[e("p",[t._v("WebM容器，VP8视频编码，Vorbis音频编码")])]),t._v(" "),e("li",[e("p",[t._v("WebM容器，VP9视频编码，Opus音频编码")])])]),t._v(" "),e("h3",{attrs:{id:"常见-mime-类型列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见-mime-类型列表"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types",target:"_blank",rel:"noopener noreferrer"}},[t._v("常见 MIME 类型列表"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/96d2d57f-44d2-4c1c-bc27-4c473312db45-2331693.jpg",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"video-是如何实现兼容多协议-多容器-多编码的js播放器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#video-是如何实现兼容多协议-多容器-多编码的js播放器"}},[t._v("#")]),t._v(" video 是如何实现兼容多协议，多容器，多编码的JS播放器")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/5cad4847-b9a0-4599-9655-0103013b789d-2331693.jpg",alt:""}})]),t._v(" "),e("h2",{attrs:{id:"播放器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#播放器"}},[t._v("#")]),t._v(" 播放器")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/sampotts/plyr",target:"_blank",rel:"noopener noreferrer"}},[t._v("plyr"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/8c42d279-a915-46e6-9436-53e792dcb8df-2331693.jpg",alt:""}})]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://videojs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("videojs"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://api2.mubu.com/v3/document_image/93601a52-ff41-4fb2-a675-3b0e638577cb-2331693.jpg",alt:""}})]),t._v(" "),e("h2",{attrs:{id:"参考资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),e("ul",[e("li",[e("p",[e("a",{attrs:{href:"https://blog.csdn.net/qq_32113629/article/details/79527418",target:"_blank",rel:"noopener noreferrer"}},[t._v("jquery 如何封装上传组件"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/Yellow-ice/p/13743400.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chrome使用video无法正常播放MP4视频的解决方案"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://juejin.cn/post/6967926253747699719",target:"_blank",rel:"noopener noreferrer"}},[t._v("web端原生video标签播放视频的一些坑"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.zhihu.com/question/319676680",target:"_blank",rel:"noopener noreferrer"}},[t._v("怎么可以让安卓浏览器可以在线看 avi 等各种格式的视频？"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.jianshu.com/p/1bfe4470349b",target:"_blank",rel:"noopener noreferrer"}},[t._v("H5直播系列二 MSE(Media Source Extensions)"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://juejin.cn/post/7220793382019694647",target:"_blank",rel:"noopener noreferrer"}},[t._v("video 是如何实现兼容多协议，多容器，多编码的JS播放器"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.pslanys.com/archives/325.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("「完全理解」video 标签到底能播放什么"),e("OutboundLink")],1),t._v("​")])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://juejin.cn/post/7015100196631609351",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端流媒体播放从入门到入坑"),e("OutboundLink")],1),t._v("​")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);