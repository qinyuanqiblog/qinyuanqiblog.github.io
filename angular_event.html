<!DOCTYPE html>
<html lang="en">

<head>
    <title>angular 事件流解析</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body ng-app="app">
    <!--父级-->
    <div ng-controller="ParentCtrl">
        <!--自己-->
        <div ng-controller="SelfCtrl">
            <a ng-click="click()">点我点我点我</a>
            <!--子级-->
            <div ng-controller="ChildCtrl"></div>
        </div>
        <!--平级-->
        <div ng-controller="BroCtrl"></div>
    </div>


<br>
    <div style="color:green;">
        点击完成之后，请在控制台查看相关信息；
    </div>
</body>

<script src="https://cdn.bootcss.com/angular.js/1.5.3/angular.min.js"></script>
<script>
    var app = angular.module('app', []);

    app.controller('SelfCtrl', function($scope) {
        $scope.click = function() {
            // 向child controller传递event与data
            $scope.$broadcast('to-child', 'child');
            // 向parent controller传递event与data
            $scope.$emit('to-parent', 'parent');
        }
    });

    app.controller('ParentCtrl', function($scope) {
        // 用于接收event与data
        $scope.$on('to-parent', function(event, data) {
            // 父级能得到值
            console.log('我是on事件里面的东西哦ParentCtrl', data);
        });

        $scope.$on('to-child', function(event, data) {
            // 子级得不到值
            console.log('ParentCtrl', data);
        });
    });

    app.controller('ChildCtrl', function($scope) {
        $scope.$on('to-child', function(event, data) {
            // 子级能得到值
            console.log('ChildCtrl', data);
        });
        $scope.$on('to-parent', function(event, data) {
            // 父级得不到值
            console.log('ChildCtrl', data);
        });
    });

    app.controller('BroCtrl', function($scope) {
        $scope.$on('to-parent', function(event, data) {
            // 平级得不到值
            console.log('BroCtrl', data);
        });
        $scope.$on('to-child', function(event, data) {
            // 平级得不到值
            console.log('BroCtrl', data);
        });
    });
</script>

</html>
